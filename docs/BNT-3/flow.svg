<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="588px" preserveAspectRatio="none" style="width:521px;height:588px;background:#FFFFFF;" version="1.1" viewBox="0 0 521 588" width="521px" zoomAndPan="magnify"><defs/><g><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="24" x2="24" y1="81.2969" y2="508.1563"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="174.5" x2="174.5" y1="81.2969" y2="508.1563"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="302.5" x2="302.5" y1="81.2969" y2="508.1563"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="453.5" x2="453.5" y1="81.2969" y2="508.1563"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32" x="5" y="77.9951">User</text><ellipse cx="24" cy="13.5" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M24,21.5 L24,48.5 M11,29.5 L37,29.5 M24,48.5 L11,63.5 M24,48.5 L37,63.5 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32" x="5" y="520.1514">User</text><ellipse cx="24" cy="531.9531" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M24,539.9531 L24,566.9531 M11,547.9531 L37,547.9531 M24,566.9531 L11,581.9531 M24,566.9531 L37,581.9531 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77" x="136.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63" x="143.5" y="69.9951">Frontend</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77" x="136.5" y="507.1563"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63" x="143.5" y="527.1514">Frontend</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="125" x="240.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111" x="247.5" y="69.9951">Service Canister</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="125" x="240.5" y="507.1563"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111" x="247.5" y="527.1514">Service Canister</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="123" x="392.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="109" x="399.5" y="69.9951">Ledger Canister</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="123" x="392.5" y="507.1563"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="109" x="399.5" y="527.1514">Ledger Canister</text><polygon fill="#181818" points="163,108.4297,173,112.4297,163,116.4297,167,112.4297" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="24" x2="169" y1="112.4297" y2="112.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="23" x="31" y="107.3638">buy</text><polygon fill="#181818" points="291,137.5625,301,141.5625,291,145.5625,295,141.5625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="175" x2="297" y1="141.5625" y2="141.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="182" y="136.4966">buy / get invoice</text><line style="stroke:#181818;stroke-width:1.0;" x1="303" x2="345" y1="170.6953" y2="170.6953"/><line style="stroke:#181818;stroke-width:1.0;" x1="345" x2="345" y1="170.6953" y2="183.6953"/><line style="stroke:#181818;stroke-width:1.0;" x1="304" x2="345" y1="183.6953" y2="183.6953"/><polygon fill="#181818" points="314,179.6953,304,183.6953,314,187.6953,310,183.6953" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="310" y="165.6294">create invoice</text><polygon fill="#181818" points="186,208.8281,176,212.8281,186,216.8281,182,212.8281" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="180" x2="302" y1="212.8281" y2="212.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="44" x="192" y="207.7622">invoice</text><polygon fill="#181818" points="35,237.9609,25,241.9609,35,245.9609,31,241.9609" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="29" x2="174" y1="241.9609" y2="241.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80" x="41" y="236.895">show invoice</text><polygon fill="#181818" points="163,267.0938,173,271.0938,163,275.0938,167,271.0938" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="24" x2="169" y1="271.0938" y2="271.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="31" y="266.0278">Confirm payment</text><polygon fill="#181818" points="442,296.2266,452,300.2266,442,304.2266,446,300.2266" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="175" x2="448" y1="300.2266" y2="300.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145" x="182" y="295.1606">transfer to subaccount</text><polygon fill="#181818" points="186,325.3594,176,329.3594,186,333.3594,182,329.3594" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="180" x2="453" y1="329.3594" y2="329.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="15" x="192" y="324.2935">ok</text><polygon fill="#181818" points="291,354.4922,301,358.4922,291,362.4922,295,358.4922" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="175" x2="297" y1="358.4922" y2="358.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="35" x="182" y="353.4263">notify</text><polygon fill="#181818" points="442,398.7578,452,402.7578,442,406.7578,446,402.7578" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="303" x2="448" y1="402.7578" y2="402.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84" x="310" y="382.5591">transfer from</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="310" y="397.6919">subaccount to main</text><polygon fill="#181818" points="314,427.8906,304,431.8906,314,435.8906,310,431.8906" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="308" x2="453" y1="431.8906" y2="431.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="15" x="320" y="426.8247">ok</text><polygon fill="#181818" points="186,457.0234,176,461.0234,186,465.0234,182,461.0234" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="180" x2="302" y1="461.0234" y2="461.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="15" x="192" y="455.9575">ok</text><polygon fill="#181818" points="35,486.1563,25,490.1563,35,494.1563,31,490.1563" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="29" x2="174" y1="490.1563" y2="490.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="41" y="485.0903">payment successful</text><!--MD5=[10976719188161f986c323e604905c6b]
@startuml
actor User as U
participant Frontend as F
participant "Service Canister" as S
participant "Ledger Canister" as L
U ->F: buy
F->S: buy / get invoice
S->S: create invoice
S- ->F: invoice
F->U: show invoice
U->F: Confirm payment
F->L: transfer to subaccount
L- ->F: ok
F->S: notify
S->L: transfer from\nsubaccount to main
L- ->S: ok
S- ->F: ok
F->U: payment successful
@enduml

PlantUML version 1.2022.6(Tue Jun 21 17:34:49 UTC 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>